(this["webpackJsonpblunt-instrument-ui"]=this["webpackJsonpblunt-instrument-ui"]||[]).push([[0],{171:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=(r=n(66))&&r.__esModule?r:{default:r};function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trevs=t,this.astb=n;var r=new Map;t.forEach((function(e){r.set(e.id,e)})),this.trevsById=r}var t,n,r;return t=e,r=[{key:"fromJSON",value:function(t){if(!t.astb||!t.trevs)throw new Error("Expected `astb` and `trevs` fields");return new e(t.trevs,a.default.fromJSON(t.astb))}},{key:"empty",value:function(){return new e([],new a.default)}}],(n=[{key:"getTrev",value:function(e){return this.trevsById.get(e)}},{key:"withDenormalizedInfo",value:function(){var t=this,n=[],r=[],a=new Map,o=function e(n){if(!n)return[];var a=r[n];if(a)return a;var o=t.getTrev(n);if(!o)throw new Error("Trev has invalid parentId [".concat(n,"]"));var i=[].concat(c(e(o.parentId)),[n]);return r[n]=i,i};this.trevs.forEach((function(e){var r=t.astb.getNode(e.astId,e.nodeId);if(!r)throw new Error("Trev id [".concat(e.id,"] has unknown node id [").concat(e.nodeId,"] for AST id [").concat(e.astId,"]"));if(e.parentId){var c=a.get(e.parentId);c||(c=[],a.set(e.parentId,c)),c.push(e.id)}var s={ancestorIds:o(e.parentId),children:[],node:r};n.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{denormalized:s}))}));var s=new e(n,this.astb);return a.forEach((function(e,t){var n=s.getTrev(t);n&&(n.denormalized.children=e.map((function(e){return s.getTrev(e)})))})),s}},{key:"withoutDenormalizedInfo",value:function(){return new e(this.trevs.map((function(e){return e.denormalized,o(e,["denormalized"])})),this.astb)}},{key:"filter",value:function(t){return new e(this.trevs.filter(t),this.astb)}},{key:"getFacets",value:function(){var e=this,t={nodes:new Map,nodeTypes:new Map,types:new Map};return this.trevs.forEach((function(n){var r=e.astb.getNode(n.astId,n.nodeId);r&&(t.nodes.set(r,(t.nodes.get(r)||0)+1),t.nodeTypes.set(r.type,(t.nodeTypes.get(r.type)||0)+1),t.types.set(n.type,(t.types.get(n.type)||0)+1))})),t}},{key:"asJSON",value:function(){var e=this.withoutDenormalizedInfo();return{astb:e.astb.asJSON(),trevs:e.trevs}}}])&&s(t.prototype,n),r&&s(t,r),e}();t.default=d},20:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addNodeIdsToAST",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"ASTBundle",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"attachCodeSlicesToAST",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"copyNodeIdsBetweenASTs",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"fromNodeKey",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"toNodeKey",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"ArrayTrace",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"ConsoleTraceWriter",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"FileTraceWriter",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"Tracer",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"TrevCollection",{enumerable:!0,get:function(){return h.default}}),t.defaultTracer=void 0;var r=p(n(753)),a=p(n(66)),o=p(n(312)),i=p(n(825)),l=p(n(826)),c=p(n(313)),s=p(n(827)),d=p(n(828)),u=p(n(829)),f=p(n(830)),h=p(n(171));function p(e){return e&&e.__esModule?e:{default:e}}var y=new f.default;t.defaultTracer=y},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,a.default)(e,(function(e){if(Number.isInteger(e.start)&&Number.isInteger(e.end)){if(e.start<0||e.end>t.length)throw new Error("Node start [".concat(e.start,"] or end [").concat(e.end,"] is out of range"));e.codeSlice=t.slice(e.start,e.end)}}))};var r,a=(r=n(97))&&r.__esModule?r:{default:r}},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"".concat(encodeURIComponent(e),":").concat(t)}},317:function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n,r=t.tracerVar,a=t.consoleWriter,o=void 0!==a&&a,c=t.fileWriterPath,b=void 0!==c&&c,m=t.astCallback,g=void 0===m?function(){}:m,O=t.astId,E=t.astSelfRegister,w=void 0===E||E,I=t.defaultEnabled,j=void 0===I||I;return{visitor:{Program:function(e){n=O||this.file.opts.filename;var t=this.file.code;if(!n)throw new Error("opts.astId is required when no filename is available");var a=function(e,t){var n=[];i.traverseFast(t.node,(function(e){(e.leadingComments||e.trailingComments||[]).forEach((function(e){var t=S.find((function(t){return function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(c){a=!0,o=c}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,1)[0].test(e.value)}));t&&(n[e.loc.start.line]=t[1])}))}));for(var r=[],a=e,o=1;o<n.length;o+=1)switch(n[o]){case"enable-line":r[o]=!0;break;case"disable-line":r[o]=!1;break;case"enable":r[o]=!0,a=!0;break;case"disable":r[o]=!1,a=!1;break;default:r[o]=a}return function(t){var n=t.loc&&t.loc.start&&t.loc.start.line;return void 0===r[n]?e:r[n]}}(j,e);(0,l.addNodeIdsToAST)(e.node),g(n,e.node,t);var c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},function(e,t){var a,l,c,s={astIdId:e.scope.generateUidIdentifier("astId"),tracerId:r?i.identifier(r):e.scope.generateUidIdentifier("tracer"),fnStartIdId:e.scope.generateUidIdentifier("fnStartId")};if(w){var d=i.stringLiteral(JSON.stringify(e.node));e.node.body.unshift(v({astIdId:s.astIdId,tracerId:s.tracerId,astString:d,codeString:i.stringLiteral(t)}))}if(e.node.body.unshift(y({astIdId:s.astIdId,astId:i.stringLiteral(n)})),"raw"===o||"encoded"===o)(a=e.node.body).unshift.apply(a,u(h({tempId:e.scope.generateUidIdentifier("temp"),tracerId:s.tracerId,encode:i.booleanLiteral("encoded"===o)})));else if(o)throw new Error("Unrecognized value of consoleWriter: ".concat(o));return b&&(l=e.node.body).unshift.apply(l,u(p({tempId:e.scope.generateUidIdentifier("temp"),tracerId:s.tracerId,prefix:i.stringLiteral(b)}))),r||(c=e.node.body).unshift.apply(c,u(f({tempId:e.scope.generateUidIdentifier("temp"),tracerId:s.tracerId}))),s}(e,t),{checkEnabled:a});e.traverse(N,{state:c})}}}};var a,o=(a=n(605))&&a.__esModule?a:{default:a},i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(144)),l=n(20);function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=(0,o.default)("\n  import { defaultTracer as %%tempId%% } from 'blunt-instrument-core';\n  const %%tracerId%% = %%tempId%%;\n"),h=(0,o.default)("\n  import { ConsoleTraceWriter as %%tempId%% } from 'blunt-instrument-core';\n  if (!%%tracerId%%.attachedConsoleWriterByPlugin) {\n    %%tracerId%%.addListener(new %%tempId%%({ encode: %%encode%% }));\n    %%tracerId%%.attachedConsoleWriterByPlugin = true;\n  }\n"),p=(0,o.default)("\n  import { FileTraceWriter as %%tempId%% } from 'blunt-instrument-core';\n  if (!%%tracerId%%.attachedFileWriterByPlugin) {\n    %%tracerId%%.addListener(new %%tempId%%({ prefix: %%prefix%% }));\n    %%tracerId%%.attachedFileWriterByPlugin = true;\n  }\n"),y=(0,o.default)("\n  const %%astIdId%% = %%astId%%;\n"),v=(0,o.default)("\n  %%tracerId%%.onRegisterAST(%%astIdId%%, JSON.parse(%%astString%%), %%codeString%%);\n"),b=(0,o.default)("{\n  const %%fnStartIdId%% = %%tracerId%%.traceFnStart(%%astIdId%%, %%nodeId%%, %%args%%);\n  try {\n    %%body%%\n  } catch (e) {\n    %%tracerId%%.traceFnThrow(%%astIdId%%, %%nodeId%%, e);\n    throw e;\n  }\n  %%tracerId%%.traceFnRet(%%astIdId%%, %%nodeId%%, undefined);\n}"),m=(0,o.default)("\n  return %%tracerId%%.traceFnRet(%%astIdId%%, %%nodeId%%, %%retval%%);\n");var g=(0,o.default)("\n  %%tracerId%%.traceExpr(%%astIdId%%, %%nodeId%%, %%expression%%)\n");var O=o.default.expression("\n  %%tracerId%%.traceFnPause(%%astIdId%%, %%nodeId%%, %%argument%%)\n"),E=o.default.expression("\n  %%tracerId%%.traceFnResume(%%astIdId%%, %%nodeId%%, %%expression%%, %%fnStartIdId%%)\n");function w(e,t){var n=t.astIdId,r=t.tracerId,a=t.fnStartIdId,o=t.checkEnabled,l=e.node;if(o(l)&&l.biId&&!l.biTracedYield){var c=O({tracerId:r,astIdId:n,nodeId:i.numericLiteral(l.biId),argument:l.argument});l.argument=c;var s=E({tracerId:r,fnStartIdId:a,astIdId:n,nodeId:i.numericLiteral(l.biId),expression:l});l.biTracedYield=!0,e.replaceWith(s)}}var I="\n  (() => {\n    const %%tempId%% = %%lval%%;\n    %%lval%% OPERATOR 1;\n    return %%tempId%%;\n  })()\n",j={"++":(0,o.default)(I.replace("OPERATOR","+=")),"--":(0,o.default)(I.replace("OPERATOR","-="))},N={UpdateExpression:function(e){var t="".concat(e.node.operator[0],"=");if(e.node.prefix){var n=i.assignmentExpression(t,e.node.argument,i.numericLiteral(1));n.biId=e.node.biId,e.replaceWith(n)}else{var r=e.node.argument,a=e.scope.generateUidIdentifier("postfix"),o=j[e.node.operator]({tempId:a,lval:r}),l=e.node.biId;e.replaceWith(o),e.node.biId=l}},Expression:{exit:function(e){i.isAwaitExpression(e.node)||i.isYieldExpression(e.node)||function(e,t){var n=t.astIdId,r=t.tracerId,a=t.checkEnabled,o=e.node;if(a(o)&&!i.isImportDeclaration(e.parentPath.node)&&(!i.isMemberExpression(o)||!i.isCallExpression(e.parentPath.node)||e.node!==e.parentPath.node.callee)&&o.biId&&!o.biTracedExpr&&e.isReferenced()&&(!(i.isObjectMethod(e.parentPath.node)||i.isClassMethod(e.parentPath.node)||i.isClassPrivateMethod(e.parentPath.node))||!e.parentPath.node.params.includes(e.node))){var l=g({tracerId:r,astIdId:n,nodeId:i.numericLiteral(o.biId),expression:o});o.biTracedExpr=!0,e.replaceWith(l)}}(e,this.state)}},Function:function(e){!function(e,t){var n=t.astIdId,r=t.tracerId,a=t.fnStartIdId,o=t.checkEnabled,l=e.node;if(o(l)&&l.biId&&!l.biTracedFn){var c=new Set(Object.keys(i.getBindingIdentifiers(l.params)));c.add("this"),c.add("arguments");var s=[];c.forEach((function(e){var t=i.identifier(e),n="this"===e?i.thisExpression():t;s.push(i.objectProperty(t,n,!1,!["this","arguments"].includes(e)))}));var d=l.body;i.isExpression(d)&&(d=m({tracerId:r,astIdId:n,nodeId:i.numericLiteral(l.biId),retval:l.body}));var u=b({body:d,tracerId:r,fnStartIdId:a,astIdId:n,nodeId:i.numericLiteral(l.biId),args:i.objectExpression(s)});l.body=u,l.biTracedFn=!0}}(e,this.state)},ReturnStatement:function(e){!function(e,t){var n=t.astIdId,r=t.tracerId,a=t.checkEnabled,o=e.node;if(a(o)&&o.biId){var l=m({tracerId:r,astIdId:n,nodeId:i.numericLiteral(o.biId),retval:o.argument});e.replaceWith(l)}}(e,this.state)},AwaitExpression:function(e){w(e,this.state)},YieldExpression:function(e){w(e,this.state)}},S=[[/^\s*bi-enable-line\s*$/,"enable-line"],[/^\s*bi-disable-line\s*$/,"disable-line"],[/^\s*bi-enable\s*$/,"enable"],[/^\s*bi-disable\s*$/,"disable"]]},318:function(e,t,n){e.exports=n(831)},323:function(e,t,n){},325:function(e,t,n){},326:function(e,t,n){},327:function(e,t,n){},328:function(e,t,n){},329:function(e,t,n){},330:function(e,t,n){},342:function(e,t,n){},54:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={countdown:"class Countdown {\n  constructor(name, from, millis) {\n    this.name = name;\n    this.from = from;\n    this.millis = millis;\n  }\n\n  start() {\n    this.intervalId = window.setInterval(this.tick.bind(this), this.millis);\n  }\n\n  tick() {\n    console.log(`${this.name}: ${this.from}`);\n    this.from--;\n    if (this.from <= 0) {\n      window.clearInterval(this.intervalId);\n    }\n  }\n}\n\nnew Countdown('A', 10, 5000).start();\nnew Countdown('B', 10, 10000).start();",factorial:"function fac(n) {\n  return n == 1 ? 1 : n * fac(n - 1);\n}\nconst result = fac(10);",fetch:"async function fetchAndLog() {\n  const response = await fetch('https://jsonplaceholder.typicode.com/todos/1');\n  const json = await response.json();\n  console.log(json);\n}\n\nfetchAndLog();",fizzBuzzGenerator:"function* fizzbuzzer(limit) {\n  for (let i = 1; i < limit; i++) {\n    if (i % 15 === 0) {\n      yield 'FizzBuzz';\n    } else if (i % 3 === 0) {\n      yield 'Fizz';\n    } else if (i % 5 === 0) {\n      yield 'Buzz';\n    } else {\n      yield i.toString();\n    }\n  }\n}\n\nconst result = Array.from(fizzbuzzer(31));",insertionSort:"function insertionSort(array) {\n  for (let i = 0; i < array.length; i++) {\n    for (let j = i - 1; j >= 0; j--) {\n      if (array[j] <= array[j + 1]) {\n        break;\n      }\n\n      const tmp = array[j + 1];\n      array[j + 1] = array[j];\n      array[j] = tmp;\n    }\n  }\n}\n\nconst a = [3, 1, 2, 5, 4];\ninsertionSort(a);"},a=r;t.default=a},597:function(e,t){},66:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(754)),a=l(n(312)),o=l(n(313)),i=l(n(97));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.asts={},this.nodesByKey=new Map,this.sources={}}var t,n,l;return t=e,l=[{key:"fromJSON",value:function(t){if(!t.asts||!t.sources)throw new Error("Expected `asts` and `sources` fields");var n=new e;return Object.keys(t.asts).forEach((function(e){n.add(e,t.asts[e],t.sources[e])})),n}}],(n=[{key:"add",value:function(e,t,n){var l=this;t=(0,r.default)(t),(0,i.default)(t,(function(t){t.biId&&(t.biASTId=e,t.biKey=(0,o.default)(e,t.biId),l.nodesByKey.set(t.biKey,t))})),(0,a.default)(t,n),this.asts[e]=t,this.sources[e]=n}},{key:"getNode",value:function(e,t){return this.nodesByKey.get((0,o.default)(e,t))}},{key:"getNodeByKey",value:function(e){return this.nodesByKey.get(e)}},{key:"filterNodes",value:function(e){var t=this,n=[];return Object.keys(this.asts).forEach((function(r){(0,i.default)(t.asts[r],(function(t){e(t)&&n.push(t)}))})),n}},{key:"asJSON",value:function(){var e=this,t={};return Object.keys(this.asts).forEach((function(n){t[n]=(0,r.default)(e.asts[n]),(0,i.default)(t[n],(function(e){delete e.biASTId,delete e.biKey,delete e.codeSlice}))})),{asts:t,sources:this.sources}}}])&&c(t.prototype,n),l&&c(t,l),e}();t.default=s},753:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=1;(0,a.default)(e,(function(e){e.biId=t,t+=1}))};var r,a=(r=n(97))&&r.__esModule?r:{default:r}},825:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=[],r=[];if((0,a.default)(e,(function(e){return n.push(e)})),(0,a.default)(t,(function(e){return r.push(e)})),n.length!==r.length)throw new Error("Source tree has ".concat(n.length," nodes but destination tree has ").concat(r.length));for(var o=0;o<n.length;o+=1){if(n[o].type!==r[o].type)throw new Error("Source node type ".concat(n[o].type," does not match destination node type ").concat(r[o].type));r[o].biId=n[o].biId}};var r,a=(r=n(97))&&r.__esModule?r:{default:r}},826:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.split(":");return{astId:decodeURIComponent(t[0]),nodeId:Number(t[1])}}},827:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(172),a=i(n(66)),o=i(n(171));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).encoder,n=void 0===t?new r.Encoder:t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.astb=new a.default,this.encoder=n,this.trevs=[]}var t,n,i;return t=e,(n=[{key:"toTC",value:function(){return new o.default(this.trevs,this.astb)}},{key:"handleRegisterAST",value:function(e,t,n){this.astb.add(e,t,n),this.onChange&&this.onChange()}},{key:"handleTrev",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{data:this.encoder.encode(e.data)});this.trevs.push(t),this.onChange&&this.onChange()}}])&&s(t.prototype,n),i&&s(t,i),e}();t.default=d},828:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(172),o=(r=n(66))&&r.__esModule?r:{default:r};function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).encode,n=void 0!==t&&t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.astb=new o.default,n&&(this.encoder=new a.Encoder)}var t,n,r;return t=e,(n=[{key:"handleRegisterAST",value:function(e,t,n){this.astb.add(e,t,n),console.log("onRegisterAST id [".concat(e,"] AST:")),this.encoder?console.log(JSON.stringify(t,null,2)):console.dir(t)}},{key:"handleTrev",value:function(e){var t="onTrev",n=this.astb.getNode(e.astId,e.nodeId);n&&n.loc&&n.loc.start&&(t+=" loc [".concat(n.loc.start.line,":").concat(n.loc.start.column,"]")),n&&n.codeSlice&&(t+=" code [".concat(n.codeSlice,"]")),t+=" trev:",console.log(t),this.encoder?console.log(JSON.stringify(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{data:this.encoder.encode(e.data)}),null,2)):console.dir(e)}}])&&c(t.prototype,n),r&&c(t,r),e}();t.default=s},829:function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,t&&t.set(e,n);return n}(n(252)),o=n(172),i=c(n(66)),l=c(n(171));function c(e){return e&&e.__esModule?e:{default:e}}function s(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t){var n=this,r=t.encoder,i=void 0===r?new o.Encoder:r,l=t.prefix,c=void 0===l?"trace":l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.encoder=i,this.filename="".concat(c,".").concat((new Date).getTime(),".tracebi"),this.ws=a.createWriteStream(this.filename),this.ws.on("error",(function(e){console.error("Error while opening or writing to trace file ".concat(n.filename,":")),console.error(e),n.endReject&&n.endReject(e)}))}var t,n,r;return t=e,r=[{key:"readToTC",value:function(e){return a.promises.readFile(e,{encoding:"utf8"}).then(this.parseToTC)}},{key:"parseToTC",value:function(e){var t=new i.default,n=[];return e.split(/[\r\n]+/).forEach((function(e){if(0!==e.length){var r=JSON.parse(e);r.ast?t.add(r.astId,r.ast,r.code):n.push(r)}})),new l.default(n,t)}}],(n=[{key:"handleRegisterAST",value:function(e,t,n){this.ws.write(JSON.stringify({astId:e,ast:t,code:n})),this.ws.write("\n")}},{key:"handleTrev",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{data:this.encoder.encode(e.data)});this.ws.write(JSON.stringify(t)),this.ws.write("\n")}},{key:"end",value:function(){var e=this;return new Promise((function(t,n){e.endReject=n,e.ws.end(t)}))}}])&&f(t.prototype,n),r&&f(t,r),e}();t.default=h},830:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners=[],this.onRegisterAST=function(){},this.onTrev=function(){},this.nextId=1,this.stack=[]}var t,n,r;return t=e,(n=[{key:"generateId",value:function(){return this.nextId++}},{key:"addListener",value:function(e){var t=this;0===this.listeners.length?(this.onRegisterAST=e.handleRegisterAST?e.handleRegisterAST.bind(e):function(){},this.onTrev=e.handleTrev?e.handleTrev.bind(e):function(){}):(this.onRegisterAST=function(e,n,r){t.listeners.forEach((function(t){t.handleRegisterAST&&t.handleRegisterAST(e,n,r)}))},this.onTrev=function(e){t.listeners.forEach((function(t){t.handleTrev&&t.handleTrev(e)}))}),this.listeners.push(e)}},{key:"pushContext",value:function(e){this.stack.push(e)}},{key:"popContext",value:function(){this.stack.pop()}},{key:"trace",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=this.generateId(),l=this.stack[this.stack.length-1];return this.onTrev(a({parentId:l,id:i,type:e,astId:t,nodeId:n,data:r},o)),i}},{key:"traceExpr",value:function(e,t,n){return this.trace("expr",e,t,n),n}},{key:"traceFnStart",value:function(e,t,n){var r=this.trace("fn-start",e,t,n);return this.pushContext(r),r}},{key:"traceFnRet",value:function(e,t,n){return this.trace("fn-ret",e,t,n),this.popContext(),n}},{key:"traceFnThrow",value:function(e,t,n){return this.trace("fn-throw",e,t,n),this.popContext(),n}},{key:"traceFnPause",value:function(e,t,n){return this.trace("fn-pause",e,t,n),this.popContext(),n}},{key:"traceFnResume",value:function(e,t,n,r){var a=this.trace("fn-resume",e,t,n,{fnStartId:r});return this.pushContext(a),n}}])&&i(t.prototype,n),r&&i(t,r),e}();t.default=l},831:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(36),i=n.n(o),l=(n(323),n(49)),c=n(6),s=n(7),d=n(8),u=n(9),f=n(1),h=n(10),p=n(39),y=n.n(p);n(325),n(326);function v(e){return null==e||"object"!==typeof e?[]:Array.isArray(e)?e.flatMap(v):e.type?[e]:Object.keys(e).flatMap((function(t){return v(e[t])}))}function b(e){var t=e.code,n=e.highlightedNodeKey,r=e.node,o=e.onHoveredNodeChange,i=e.onNodeSelectedToggle,l=e.selectedNodeKeys,c=r.biKey,s=r.start,d=r.end,u=s,f=[];if("ObjectProperty"===r.type&&r.shorthand)return a.a.createElement(b,{key:r.value.biKey,highlightedNodeKey:n,node:r.value,selectedNodeKeys:l,code:t,onHoveredNodeChange:o,onNodeSelectedToggle:i});var h=function(e){return Object.keys(e).flatMap((function(t){return v(e[t])}))}(r).sort((function(e,t){return e.start-t.start})),p=!0,y=!1,m=void 0;try{for(var g,O=h[Symbol.iterator]();!(p=(g=O.next()).done);p=!0){var E=g.value;u<E.start&&f.push(t.slice(u,E.start)),f.push(a.a.createElement(b,{key:E.biKey,highlightedNodeKey:n,node:E,selectedNodeKeys:l,code:t,onHoveredNodeChange:o,onNodeSelectedToggle:i})),u=E.end}}catch(N){y=!0,m=N}finally{try{p||null==O.return||O.return()}finally{if(y)throw m}}u<d&&f.push(t.slice(u,d));var w=c&&o?function(e){o(c),e.stopPropagation()}:null,I=c&&i?function(e){i(c),e.stopPropagation()}:null,j=[c&&c===n?"highlighted":"",c&&l.includes(c)?"selected":""].join(" ");return a.a.createElement("span",{className:j,onClick:I,onMouseOver:w},f)}var m=function(e){var t=e.ast,n=e.highlightedNodeKey,r=e.onHoveredNodeChange,o=void 0===r?null:r,i=e.onNodeSelectedToggle,l=void 0===i?null:i,c=e.selectedNodeKeys,s=void 0===c?[]:c,d=o?function(){return o(null)}:null;return a.a.createElement("pre",{className:"AnnotatedCode",onMouseLeave:d},a.a.createElement("code",null,a.a.createElement(b,{highlightedNodeKey:n,node:t,selectedNodeKeys:s,code:t.codeSlice,onHoveredNodeChange:o,onNodeSelectedToggle:l})))},g=n(55),O=n(16);n(327);function E(e){var t=e.highlightedNodeKey,n=e.object,r=e.onHoveredNodeChange,o=e.onNodeSelectedToggle,i=e.selectedNodeKeys,l=n.biId,c=n.biKey,s=n.type,d=n.loc,u=(n.biASTId,n.start,n.end,n.codeSlice,Object(O.a)(n,["biId","biKey","type","loc","biASTId","start","end","codeSlice"])),f=s?a.a.createElement("span",{className:"type"},s):null,h=l?a.a.createElement("span",{className:"nodeId"},l):null,p=d?a.a.createElement("span",{className:"loc"},function(e){var t=e.start,n=e.end;return t.line+":"+t.column+"-"+n.line+":"+n.column}(d)):null,y=[];for(var v in u){var b=u[v];Array.isArray(b)&&0===b.length||"object"===typeof b&&(null==b||0===Object.keys(b).length)||"undefined"===typeof b||(Array.isArray(b)?y.push([1,v,a.a.createElement("ol",null,b.map((function(e,n){return a.a.createElement("li",{key:n},a.a.createElement(E,{object:e,highlightedNodeKey:t,onHoveredNodeChange:r,onNodeSelectedToggle:o,selectedNodeKeys:i}))})))]):"object"===typeof b&&null!=b?y.push([1,v,a.a.createElement(E,{object:b,highlightedNodeKey:t,onHoveredNodeChange:r,onNodeSelectedToggle:o,selectedNodeKeys:i})]):y.push([0,v,a.a.createElement("span",{className:"primitive"},JSON.stringify(b))]))}y.sort();var m=c&&r?function(e){r(c),e.stopPropagation()}:null,w=c&&o?function(e){o(c),e.stopPropagation()}:null,I=["object",c?"node":null,c&&c===t?"highlighted":null,c&&i.includes(c)?"selected":null].join(" ");return a.a.createElement("div",{className:I,onMouseOver:m,onClick:w},h," ",f," ",p,a.a.createElement("dl",null,y.map((function(e,t){var n=Object(g.a)(e,3),r=(n[0],n[1]),o=n[2];return[a.a.createElement("dt",{key:"k"+t},r),a.a.createElement("dd",{key:"v"+t},o)]}))))}var w=function(e){var t=e.ast,n=e.highlightedNodeKey,r=e.onHoveredNodeChange,o=void 0===r?null:r,i=e.onNodeSelectedToggle,l=void 0===i?null:i,c=e.selectedNodeKeys,s=void 0===c?[]:c,d=o?function(){return o(null)}:null;return a.a.createElement("div",{className:"ASTNav",onMouseLeave:d},a.a.createElement(E,{object:t,highlightedNodeKey:n,onHoveredNodeChange:o,onNodeSelectedToggle:l,selectedNodeKeys:s}))};n(328);function I(e){var t=e.data,n=e.trevType,r=[],o=1;return function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==t)if(null!==t)switch(typeof t){case"number":return void r.push(a.a.createElement("span",{key:o++,className:"preview-number ".concat(i)},t));case"boolean":return void r.push(a.a.createElement("span",{key:o++,className:"preview-boolean ".concat(i)},t.toString()));case"string":return void r.push(a.a.createElement("span",{key:o++,className:"preview-string ".concat(i)},JSON.stringify(t)));case"object":switch(t.type){case"array":var c=Object.keys(t);r.push(a.a.createElement("span",{key:o++,className:"preview-array-start"},"["));for(var s=0,d=l,u=0;u<c.length;u++){var f=c[u];if("type"!==f&&"id"!==f){if(s>0&&r.push(a.a.createElement("span",{key:o++,className:"preview-array-comma"},",")),s>4||f!==".".concat(s)){r.push(a.a.createElement("span",{key:o++,className:"preview-array-more"},"..."));break}d=d&&(null===t[f]||"boolean"===typeof t[f]||"number"===typeof t[f]),s++,e(t[f],d?"preview-array-fixed-element":"")}}return void r.push(a.a.createElement("span",{key:o++,className:"preview-array-end"},"]"));case"bigint":return void r.push(a.a.createElement("span",{key:o++,className:"preview-bigint ".concat(i)},t.string));case"builtin":return void r.push(a.a.createElement("span",{key:o++,className:"preview-builtin ".concat(i)},t.name));case"function":if(t[".name"]&&t[".name"].value)r.push(a.a.createElement("span",{key:o++,className:"preview-function ".concat(i)},t[".name"].value));else{var h=t.source.slice(0,20);h.length<t.source.length&&(h+="..."),r.push(a.a.createElement("span",{key:o++,className:"preview-function ".concat(i)},h))}return;case"object":r.push(a.a.createElement("span",{key:o++,className:"preview-object-start"},"{"));for(var p=!1,y=Object.keys(t),v=0,b=0;b<y.length;b++){var m=y[b];if("type"!==m&&"id"!==m)if(!l||".arguments"!==m&&".this"!==m||"fn-start"!==n)if("prototype"!==m){if(v>4||!m.startsWith(".")){p=!0;break}v>0&&r.push(a.a.createElement("span",{key:o++,className:"preview-object-comma"},",")),v++,r.push(a.a.createElement("span",{key:o++,className:"preview-object-key"},m.slice(1))),r.push(a.a.createElement("span",{key:o++,className:"preview-object-colon"},":")),e(t[m])}else p=!0;else p=!0}return p&&(v>0&&r.push(a.a.createElement("span",{key:o++,className:"preview-object-comma"},",")),r.push(a.a.createElement("span",{key:o++,className:"preview-object-more"},"..."))),void r.push(a.a.createElement("span",{key:o++,className:"preview-object-end"},"}"));case"symbol":return void(t.description?r.push(a.a.createElement("span",{key:o++,className:"preview-symbol ".concat(i)},"~",t.description)):r.push(a.a.createElement("span",{key:o++,className:"preview-symbol ".concat(i)},"~",t.id)));default:return void r.push(JSON.stringify(t))}default:return void r.push("???")}else r.push(a.a.createElement("span",{key:o++,className:"preview-null ".concat(i)},"null"))}(t,"",!0),r}n(329);var j=function(e){var t=e.trevs,n=e.highlightedTrevId,r=e.highlightedNodeKey,o=e.onHoveredTrevChange,i=void 0===o?function(e){}:o,l=e.onNodeSelectedToggle,c=void 0===l?function(e){}:l,s=e.onOpenModalData,d=void 0===s?function(e){}:s,u=e.onTrevTypeSelectedToggle,f=void 0===u?function(e){}:u,h=[],p=!0,y=!1,v=void 0;try{for(var b,m=function(){var e=b.value,t=i?function(t){i(e.id)}:null,o=[null!=n&&e.id===n?"highlighted-trev":null,null!=n&&e.denormalized.ancestorIds.includes(n)?"highlighted-trev-descendant":null,null!=r&&e.denormalized.node.biKey===r?"highlighted-node":null].join(" ");h.push(a.a.createElement("tr",{key:e.id,onMouseOver:t,className:o},a.a.createElement("td",{className:"parent-id"},e.parentId),a.a.createElement("td",{className:"id"},e.id),a.a.createElement("td",{className:"type",onClick:function(){return f(e.type)}},e.type),a.a.createElement("td",{className:"node",onClick:function(){return c(e.denormalized.node.biKey)}},a.a.createElement("code",null,e.denormalized.node.codeSlice)),a.a.createElement("td",{className:"data",onClick:function(){return d({data:e.data})}},a.a.createElement(I,{data:e.data,trevType:e.type}))))},g=t[Symbol.iterator]();!(p=(b=g.next()).done);p=!0)m()}catch(E){y=!0,v=E}finally{try{p||null==g.return||g.return()}finally{if(y)throw v}}var O=i?function(){return i(null)}:null;return a.a.createElement("div",{className:"TrevTable"},a.a.createElement("table",{onMouseLeave:O},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",{className:"parent-id"},"parent"),a.a.createElement("th",{className:"id"},"id"),a.a.createElement("th",{className:"type"},"type"),a.a.createElement("th",{className:"node"},"code"),a.a.createElement("th",{className:"data"},"data"))),a.a.createElement("tbody",null,h)))},N=(n(330),n(105));var S=function(e){var t=e.onTraceQueryChange,n=void 0===t?function(e){}:t,r=e.onPlay,o=void 0===r?function(){}:r,i=e.onStop,l=void 0===i?function(){}:i,c=e.isPlaying,s=e.query,d=e.tc,u=e.astNames;function f(e,t){var n=e.biKey,r=Object.keys(u).length>1?"".concat(u[e.biASTId],":"):"",a=e.codeSlice,o=a.length>20?a.slice(0,20)+"...":a,i="[".concat(r).concat(e.biId,"] ").concat(e.type,": ").concat(o);return void 0!==t&&(i+=" (".concat(t,")")),{value:n,label:i}}var h=d.getFacets(),p=Array.from(h.nodes.entries()).map((function(e){var t=Object(g.a)(e,2);return f(t[0],t[1])})),v=Object.keys(s.nodes).filter((function(e){return s.nodes[e]})).map((function(e){return f(d.astb.getNodeByKey(e))})),b=Array.from(h.nodeTypes.entries()).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return{value:n,label:"".concat(n," (").concat(r,")")}})),m=Object.keys(s.nodeTypes).filter((function(e){return s.nodeTypes[e]})).map((function(e){return{value:e,label:e}})),O=Array.from(h.types.entries()).map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];return{value:n,label:"".concat(n," (").concat(r,")")}})),E=Object.keys(s.types).filter((function(e){return s.types[e]})).map((function(e){return{value:e,label:e}}));return a.a.createElement("form",{className:"TraceQueryForm"},a.a.createElement("div",{className:"filter"},a.a.createElement("label",{className:"label",id:"node-filters-label"},"Nodes:"),a.a.createElement(N.a,{className:"filter-select",classNamePrefix:"filter-select",isMulti:!0,options:p,value:v,onChange:function(e){var t={};(e||[]).forEach((function(e){t[e.value]=!0})),n(y()(s,{nodes:{$set:t}}))},placeholder:"(all)","aria-labelledby":"node-filters-select"})),a.a.createElement("div",{className:"filter"},a.a.createElement("label",{className:"label",id:"node-type-filters-label"},"Node types:"),a.a.createElement(N.a,{className:"filter-select",classNamePrefix:"filter-select",isMulti:!0,options:b,value:m,onChange:function(e){var t={};(e||[]).forEach((function(e){t[e.value]=!0})),n(y()(s,{nodeTypes:{$set:t}}))},placeholder:"(all)","aria-labelledby":"node-type-filters-label"})),a.a.createElement("div",{className:"filter"},a.a.createElement("label",{className:"label",id:"type-filters-label"},"Trev types:"),a.a.createElement(N.a,{className:"filter-select",classNamePrefix:"filter-select",isMulti:!0,options:O,value:E,onChange:function(e){var t={};(e||[]).forEach((function(e){t[e.value]=!0})),n(y()(s,{types:{$set:t}}))},placeholder:"(all)","aria-labelledby":"type-filters-label"})),a.a.createElement("div",{className:"walkthrough-controls"},c?a.a.createElement("button",{onClick:function(e){e.preventDefault(),l()}},"\u23f9"):a.a.createElement("button",{onClick:function(e){e.preventDefault(),o()}},"\u25b6")))},T=n(4),k=(n(333),n(54)),P=n.n(k),C=n(104),D=n.n(C),A=n(315),M=n.n(A),x=n(316),_=n.n(x);n(342);function K(e){var t=e.data;switch(typeof t){case"boolean":return a.a.createElement("p",{className:"LargeDataPreview boolean"},t.toString());case"string":return a.a.createElement("pre",{className:"LargeDataPreview string"},t);case"number":return a.a.createElement("p",{className:"LargeDataPreview number"},t);default:return a.a.createElement("pre",{className:"LargeDataPreview object"},a.a.createElement("code",null,JSON.stringify(t,null,2)))}}var R=function(e){var t=e.tc,n=e.filteredTC,r=e.traceQuery,o=e.highlightedTrevId,i=e.highlightedNodeKey,l=e.onTraceQueryChange,c=e.onHoveredTrevChange,s=e.onHoveredNodeChange,d=e.onLoadByFile,u=e.onLoadByPaste,f=e.onNodeSelectedToggle,h=e.onRun,p=e.onSourceDraftChange,v=e.onOpenModalData,b=e.onCloseModalData,g=e.onPlay,O=e.onStop,E=e.isPlaying,I=e.modalData,N=e.status,k=e.sourceDraft,C=Object.keys(r.nodes).filter((function(e){return r.nodes[e]})),A="",x=[a.a.createElement("option",{key:"BLANK",value:""})];for(var R in P.a)x.push(a.a.createElement("option",{key:R,value:R},R)),k===P.a[R]&&(A=R);var F=a.a.createElement("p",{className:"status"},"\xa0"),z=a.a.createElement("p",{className:"status"});switch(N.action){case"run":F=N.error?a.a.createElement("p",{className:"status error"},N.error.toString()):N.tracedError?a.a.createElement("p",{className:"status warning"},"Ran and received error: ",N.tracedError.toString()):a.a.createElement("p",{className:"status"},"Ran successfully.");break;case"load":z=N.error?a.a.createElement("p",{className:"status error"},N.error.toString()):a.a.createElement("p",{className:"status"},"Loaded trace successfully.")}var L=Object.keys(t.astb.asts);L.sort();var B,J=function(e){if(0===e.length)return{};for(var t=e.map((function(e){return e.split("/")}));t.every((function(e){return e.length>1&&e[0]===t[0][0]}));)t.forEach((function(e){return e.shift()}));for(var n=t.map((function(e){return e.join("/")})),r={},a=0;a<e.length;a+=1)r[e[a]]=n[a];return r}(L);return a.a.createElement("div",{className:"App"},a.a.createElement("div",{className:"control-tabs"},a.a.createElement(T.d,null,a.a.createElement(T.b,null,a.a.createElement(T.a,null,"Run"),a.a.createElement(T.a,null,"Save"),a.a.createElement(T.a,null,"Load")),a.a.createElement(T.c,null,a.a.createElement("form",{className:"source-form"},a.a.createElement("p",{className:"instructions"},"Enter javascript code & click Run, or choose an example:",a.a.createElement("select",{title:"Choose an example",value:A,onChange:function(e){h(P.a[e.target.value]||"")}},x)),a.a.createElement("textarea",{title:"Enter source code to run",value:k,onChange:function(e){return p(e.target.value)},autoComplete:"false",autoCorrect:"false",spellCheck:"false"}),a.a.createElement("div",{className:"status-area"},a.a.createElement("button",{className:"run",onClick:(B=k,function(e){e.preventDefault(),h(B)})},"Run"),F))),a.a.createElement(T.c,null,a.a.createElement("div",{className:"save-form"},a.a.createElement("p",null,"You can export the trace & AST to load later."),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("button",{className:"view-save",onClick:function(){return v(t.asJSON())}},"View JSON in browser")),a.a.createElement("li",null,"Or ",a.a.createElement("button",{className:"file-save",onClick:function(e){var n=JSON.stringify(t.asJSON(),null,2),r=new Blob([n],{type:"application/json"});_.a.saveAs(r,"trace.json")}},"save to file"))))),a.a.createElement(T.c,null,a.a.createElement("div",{className:"load-form"},a.a.createElement("p",null,"You can load a `.json` file saved by this UI or a `.tracebi` file saved by FileTraceWriter."),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("label",{htmlFor:"load-paste"},"Paste the JSON here: "),a.a.createElement("input",{id:"load-paste",value:"",type:"text",onChange:function(){},onPaste:function(e){var t=(e.clipboardData||window.clipboardData).getData("text");t&&u(t),e.preventDefault()}})),a.a.createElement("li",null,a.a.createElement("label",{htmlFor:"load-file"},"Or load from a file: "),a.a.createElement("input",{id:"load-file",value:"",type:"file",accept:".json, .tracebi",onChange:function(e){var t=e.target.files;t.length<1||d(t[0])}}))),a.a.createElement("div",{className:"status-area"},z))))),a.a.createElement("div",{className:"code-tabs"},a.a.createElement(T.d,null,a.a.createElement(T.b,null,a.a.createElement(T.a,null,"Code"),a.a.createElement(T.a,null,"AST"),a.a.createElement(T.a,null,"AST JSON"),t.astb.instrumentedAST?a.a.createElement(T.a,null,"Instrumented Code"):null),a.a.createElement(T.c,null,L.map((function(e){return a.a.createElement("section",{key:e},L.length>1?a.a.createElement("h1",null,J[e]):null,a.a.createElement(m,{ast:t.astb.asts[e],highlightedNodeKey:i,onHoveredNodeChange:s,onNodeSelectedToggle:f,selectedNodeKeys:C}))}))),a.a.createElement(T.c,null,L.map((function(e){return a.a.createElement("section",{key:e},L.length>1?a.a.createElement("h1",null,J[e]):null,a.a.createElement(w,{ast:t.astb.asts[e],highlightedNodeKey:i,onHoveredNodeChange:s,onNodeSelectedToggle:f,selectedNodeKeys:C}))}))),a.a.createElement(T.c,null,a.a.createElement(D.a,{src:t.astb.asJSON(),name:!1})),t.astb.instrumentedAST?a.a.createElement(T.c,null,a.a.createElement(m,{ast:t.astb.instrumentedAST,highlightedNodeKey:i,onHoveredNodeChange:s,onNodeSelectedToggle:f,selectedNodeKeys:C})):null)),a.a.createElement(S,{onTraceQueryChange:l,onNodeSelectedToggle:f,tc:t,query:r,onPlay:g,onStop:O,isPlaying:E,astNames:J}),a.a.createElement("div",{className:"trev-tabs"},a.a.createElement(T.d,null,a.a.createElement(T.b,null,a.a.createElement(T.a,null,"Trace Events"),a.a.createElement(T.a,null,"Trevs JSON")),a.a.createElement(T.c,null,a.a.createElement(j,{trevs:n.trevs,highlightedTrevId:o,highlightedNodeKey:i,onHoveredTrevChange:c,onNodeSelectedToggle:f,onOpenModalData:v,onTrevTypeSelectedToggle:function(e){l(y()(r,{types:{$toggle:[e]}}))}})),a.a.createElement(T.c,null,a.a.createElement(D.a,{src:n.withoutDenormalizedInfo().trevs,name:!1,displayDataTypes:!1})))),a.a.createElement("div",{className:"large-data-preview"},o?a.a.createElement(K,{data:t.getTrev(o).data}):a.a.createElement("p",null)),a.a.createElement("div",{className:"blurb"},"created by ",a.a.createElement("a",{href:"https://brokensandals.net"},"brokensandals")," | documentation and source code on ",a.a.createElement("a",{href:"https://github.com/brokensandals/blunt-instrument"},"github")),a.a.createElement(M.a,{isOpen:void 0!==I,onRequestClose:b,contentLabel:"Data Inspector",shouldCloseOnOverlayClick:!0},a.a.createElement(D.a,{src:I,name:!1,displayDataTypes:!1})))},F=n(2),z=n(69),L=n(317),B=n.n(L),J=n(20);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Object(F.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=e.getBoundingClientRect(),a=t.getBoundingClientRect();return!(a.bottom-n<r.top||a.top+n>r.bottom||a.right-n<r.left||a.left+n>r.right)}var U={traceQuery:{nodes:{},nodeTypes:{},types:{}},highlightedTrevId:null,highlightedNodeKey:null},$=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).state=Object(l.a)({},U),Object.assign(n.state,n.doRun(P.a.factorial)),n.handleTraceQueryChange=n.handleTraceQueryChange.bind(Object(f.a)(n)),n.handleHoveredTrevChange=n.handleHoveredTrevChange.bind(Object(f.a)(n)),n.handleHoveredNodeChange=n.handleHoveredNodeChange.bind(Object(f.a)(n)),n.handleLoadByPaste=n.loadFromJSONText.bind(Object(f.a)(n)),n.handleLoadByFile=n.handleLoadByFile.bind(Object(f.a)(n)),n.handleNodeSelectedToggle=n.handleNodeSelectedToggle.bind(Object(f.a)(n)),n.handleRun=n.handleRun.bind(Object(f.a)(n)),n.handleSourceDraftChange=n.handleSourceDraftChange.bind(Object(f.a)(n)),n.handleOpenModalData=n.handleOpenModalData.bind(Object(f.a)(n)),n.handleCloseModalData=n.handleCloseModalData.bind(Object(f.a)(n)),n.handlePlay=n.handlePlay.bind(Object(f.a)(n)),n.handleStop=n.handleStop.bind(Object(f.a)(n)),n}return Object(h.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){document.querySelectorAll(".code-tabs .react-tabs__tab-panel").forEach((function(e){var t=e.querySelector(".highlighted");t&&!Q(t,e)&&t.scrollIntoView({behavior:"smooth"})})),document.querySelectorAll(".trev-tabs .react-tabs__tab-panel").forEach((function(e){var t=e.querySelector(".highlighted-trev");if(t)Q(t,e)||t.scrollIntoView({behavior:"smooth"});else{var n=e.querySelectorAll(".highlighted-node");n.length>0&&!Array.from(n).some((function(t){return Q(t,e)}))&&n[0].scrollIntoView({behavior:"smooth"})}}))}},{key:"handleTraceQueryChange",value:function(e){this.setState(this.doQuery(this.state.tc,e))}},{key:"handleHoveredTrevChange",value:function(e){this.handleHoveredNodeChange(null==e?null:this.state.tc.getTrev(e).denormalized.node.biKey),this.setState({highlightedTrevId:e})}},{key:"handleHoveredNodeChange",value:function(e){this.setState({highlightedNodeKey:e})}},{key:"handleLoadByFile",value:function(e){var t=this;try{var n=new FileReader;n.onerror=function(e){n.abort(),t.setState({action:"load",error:"Error while reading file"})},n.onload=function(){t.loadFromJSONText(n.result)},n.readAsText(e)}catch(r){this.setState({action:"load",error:r})}}},{key:"loadFromJSONText",value:function(e){var t,n,r={action:"load"};try{var a=JSON.parse(e);t=J.TrevCollection.fromJSON(a)}catch(o){try{t=J.FileTraceWriter.parseToTC(e)}catch(i){r.error="Failed to parse as TrevCollection json [error=".concat(o,"] or as FileTraceWriter output [error=").concat(i,"]"),console.log(o),console.log(i),t=J.TrevCollection.empty()}}n=(t=t.withDenormalizedInfo()).astb.asts.eval&&t.astb.asts.eval.codeSlice||"",this.setState(Object(l.a)({tc:t,status:r,sourceDraft:n},U,{},this.doQuery(t,U.traceQuery)))}},{key:"handleNodeSelectedToggle",value:function(e){this.handleTraceQueryChange(y()(this.state.traceQuery,{nodes:{$toggle:[e]}}))}},{key:"handleOpenModalData",value:function(e){this.setState(Object(l.a)({},this.state,{modalData:e}))}},{key:"handleCloseModalData",value:function(){this.setState(Object(l.a)({},this.state,{modalData:void 0}))}},{key:"handlePlay",value:function(){var e=this;if(this.handleStop(),0!==this.state.filteredTC.trevs.length){var t=0,n=function(){t>=e.state.filteredTC.trevs.length?e.handleStop():(e.handleHoveredTrevChange(e.state.filteredTC.trevs[t].id),t+=1)};n();var r=window.setInterval(n,1e3);this.setState({walkthroughTimerId:r})}}},{key:"handleStop",value:function(){this.state.walkthroughTimerId&&(this.handleHoveredTrevChange(null),window.clearInterval(this.state.walkthroughTimerId),this.setState({walkthroughTimerId:void 0}))}},{key:"doRun",value:function(e){var t,n,r=this,a={action:"run"};try{t=(n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.saveInstrumented,r=void 0!==n&&n,a="_bie_tracer";e.includes(a)&&console.warn('Code includes "'.concat(a,'", which is defined by instrumentedEval. This\nmay interfere with instrumentedEval, the code, or both.'));var o=new J.ArrayTrace,i=new J.Tracer;i.addListener(o);var l={configFile:!1,plugins:[[B.a,{tracerVar:a,astCallback:o.handleRegisterAST.bind(o),astId:"eval",astSelfRegister:!1}]]};r&&(l.ast=!0);var c=Object(z.transformSync)(e,W({ast:!0,sourceType:"module"},l)),s=o.astb.asts.eval;if(!s)throw new Error("blunt-instrument-babel-plugin did not invoke callback with AST");var d=c.code,u=new Function(a,'"use strict";'.concat(d));try{u(i)}catch(p){o.error=p}if(r){var f=Object(z.parseSync)(d);Object(J.copyNodeIdsBetweenASTs)(c.ast,f);var h=new J.ASTBundle;h.add("eval",f,d),o.astb.instrumentedAST=h.asts.eval}return o}(e,{saveInstrumented:!0})).toTC().withDenormalizedInfo(),a.tracedError=n.error;var o=!1;n.onChange=function(){o||(o=!0,window.setTimeout((function(){if(o=!1,r.state.trace===n){var e=n.toTC().withDenormalizedInfo();r.setState(Object(l.a)({tc:e},r.doQuery(e,r.state.traceQuery)))}})))}}catch(i){console.log(i),t=J.TrevCollection.empty(),a.error=i}return Object(l.a)({tc:t,trace:n,status:a,sourceDraft:e},U,{},this.doQuery(t,U.traceQuery))}},{key:"doQuery",value:function(e,t){var n=Object.keys(t.nodes).filter((function(e){return t.nodes[e]})),r=Object.keys(t.nodeTypes).filter((function(e){return t.nodeTypes[e]})),a=Object.keys(t.types).filter((function(e){return t.types[e]}));return{filteredTC:e.filter((function(e){return(0===n.length||n.includes(e.denormalized.node.biKey))&&(0===r.length||r.includes(e.denormalized.node.type))&&(0===a.length||a.includes(e.type))})),traceQuery:t}}},{key:"handleRun",value:function(e){this.setState(this.doRun(e))}},{key:"handleSourceDraftChange",value:function(e){this.setState({sourceDraft:e})}},{key:"render",value:function(){return a.a.createElement(R,{tc:this.state.tc,filteredTC:this.state.filteredTC,traceQuery:this.state.traceQuery,sourceDraft:this.state.sourceDraft,highlightedTrevId:this.state.highlightedTrevId,highlightedNodeKey:this.state.highlightedNodeKey,onTraceQueryChange:this.handleTraceQueryChange,onHoveredTrevChange:this.handleHoveredTrevChange,onHoveredNodeChange:this.handleHoveredNodeChange,onLoadByFile:this.handleLoadByFile,onLoadByPaste:this.handleLoadByPaste,onNodeSelectedToggle:this.handleNodeSelectedToggle,onRun:this.handleRun,onSourceDraftChange:this.handleSourceDraftChange,onOpenModalData:this.handleOpenModalData,onCloseModalData:this.handleCloseModalData,onPlay:this.handlePlay,onStop:this.handleStop,isPlaying:!!this.state.walkthroughTimerId,modalData:this.state.modalData,status:this.state.status})}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},97:function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){if(!t||"object"!==r(t))return;t.type&&n(t);Object.values(t).forEach((function(t){return e(t,n)}))}}},[[318,1,2]]]);
//# sourceMappingURL=main.f8795ce5.chunk.js.map